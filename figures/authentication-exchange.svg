<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   viewBox="0 0 698.78501 349.08"
   id="svg4528"
   version="1.1"
   inkscape:version="0.47 r22583"
   width="100%"
   height="100%"
   sodipodi:docname="authentication-exchange.svg"
   inkscape:export-filename="/users/tcheneau/work/project/ecc-light-certificate/figures/authentication-exchange.png"
   inkscape:export-xdpi="100"
   inkscape:export-ydpi="100">
  <metadata
     id="metadata4623">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title>blockdiag</dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <sodipodi:namedview
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1"
     objecttolerance="10"
     gridtolerance="10"
     guidetolerance="10"
     inkscape:pageopacity="0"
     inkscape:pageshadow="2"
     inkscape:window-width="1598"
     inkscape:window-height="1179"
     id="namedview4621"
     showgrid="false"
     inkscape:zoom="1.885618"
     inkscape:cx="327.66597"
     inkscape:cy="181.97781"
     inkscape:window-x="1680"
     inkscape:window-y="19"
     inkscape:window-maximized="0"
     inkscape:current-layer="svg4528" />
  <defs
     id="defs_block">
    <inkscape:perspective
       sodipodi:type="inkscape:persp3d"
       inkscape:vp_x="0 : 198 : 1"
       inkscape:vp_y="0 : 1000 : 0"
       inkscape:vp_z="754 : 198 : 1"
       inkscape:persp3d-origin="377 : 132 : 1"
       id="perspective4625" />
    <filter
       height="1.5039999"
       id="filter_blur"
       inkscape:collect="always"
       width="1.1575"
       x="-0.078749999"
       y="-0.252"
       color-interpolation-filters="sRGB">
      <feGaussianBlur
         id="feGaussianBlur3780"
         inkscape:collect="always"
         stdDeviation="4.2" />
    </filter>
  </defs>
  <title
     id="title4533">blockdiag</title>
  <desc
     id="desc4535">// build the svg with
// seqdiag -T svg key-exchange.txt
seqdiag {
  default_fontsize = 16;  // default value is 11
  activation = none;
  default_note_color = white;

  &quot;supplicant\n(A)&quot; -&gt; &quot;authenticator\n(B)&quot; [label = &quot;m1: seq, pubA, QA, sigA&quot;, leftnote = &quot;- generate dA\n- derive QA=dA.GA\n&quot;];
  &quot;authenticator\n(B)&quot; -&gt; &quot;supplicant\n(A)&quot; [label = &quot;m2: seq, pubB, QB, sigB&quot;,
                                    leftnote = &quot;-compute shared secret dA.QB&quot;,
                                     rightnote = &quot;-derive QB=dB.QB\n-compute shared secret dB.QA&quot;];
  === Both supplicant and authenticator share a same secret\ndA.QB=dB.QA=dA.dB.G ===
}
</desc>
  <polygon
     points="272,152 272,180 110,180 110,144 110,144 264,144 "
     style="font-size:16px;opacity:0.7;fill:#000000;fill-opacity:1;stroke:#000000;stroke-width:1.05079579;filter:url(#filter_blur);font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter"
     id="polygon4537"
     transform="matrix(0.8282308,0,0,1.0934829,14.032654,-47.939234)" />
  <polygon
     points="272,258 27,258 27,239 27,239 264,239 272,247 "
     style="font-size:16px;opacity:0.7;fill:#000000;fill-opacity:1;stroke:#000000;stroke-width:0.90619361;filter:url(#filter_blur);font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter"
     id="polygon4539"
     transform="matrix(0.93211646,0,0,1.3064351,-15.271411,-105.56913)" />
  <polygon
     points="496,230 496,230 733,230 741,238 741,266 496,266 "
     style="font-size:16px;opacity:0.7;fill:#000000;fill-opacity:1;stroke:#000000;stroke-width:1.0242523;filter:url(#filter_blur);font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter"
     id="polygon4541"
     transform="matrix(0.93070222,0,0,1.0241779,-0.74682092,-39.095054)" />
  <rect
     height="40"
     style="font-size:16px;opacity:0.7;fill:#000000;fill-opacity:1;stroke:#000000;stroke-width:1;filter:url(#filter_blur);font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter"
     width="128"
     x="189.58"
     y="10.580004"
     id="rect4543" />
  <rect
     height="40"
     style="font-size:16px;opacity:0.7;fill:#000000;fill-opacity:1;stroke:#000000;stroke-width:1;filter:url(#filter_blur);font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter"
     width="128"
     x="381.58002"
     y="10.580004"
     id="rect4545" />
  <path
     d="m 250.58,44.58 0,304"
     id="path4547"
     style="font-size:16px;fill:none;stroke:#000000;stroke-width:1;stroke-dasharray:8, 4;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter" />
  <path
     d="m 442.58,44.58 0,304"
     id="path4549"
     style="font-size:16px;fill:none;stroke:#000000;stroke-width:1;stroke-dasharray:8, 4;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter" />
  <rect
     height="40"
     width="128"
     x="186.58"
     y="4.5800037"
     id="rect4551"
     style="font-size:16px;fill:#ffffff;stroke:#000000;stroke-width:1;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter" />
  <text
     font-size="16"
     font-style="normal"
     font-weight="normal"
     x="229.58"
     y="21.58"
     id="text4553"
     style="font-size:16px;font-style:normal;font-weight:normal;fill:#000000;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter">Client</text>
  <text
     font-size="16"
     font-style="normal"
     font-weight="normal"
     x="240.58"
     y="38.579998"
     id="text4555"
     style="font-size:16px;font-style:normal;font-weight:normal;fill:#000000;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter">(A)</text>
  <rect
     height="40"
     width="128"
     x="378.58002"
     y="4.5800037"
     id="rect4557"
     style="font-size:16px;fill:#ffffff;stroke:#000000;stroke-width:1;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter" />
  <text
     font-size="16"
     font-style="normal"
     font-weight="normal"
     x="417.58002"
     y="20.58"
     id="text4559"
     style="font-size:16px;font-style:normal;font-weight:normal;fill:#000000;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter">Server</text>
  <text
     font-size="16"
     font-style="normal"
     font-weight="normal"
     x="432.57999"
     y="37.579998"
     id="text4561"
     style="font-size:16px;font-style:normal;font-weight:normal;fill:#000000;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter">(B)</text>
  <path
     d="m 258.58,120.58 176,0"
     id="path4563"
     style="font-size:16px;fill:none;stroke:#000000;stroke-width:1;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter" />
  <polygon
     points="461,152 469,156 461,160 "
     id="polygon4565"
     style="font-size:16px;fill:#000000;stroke:#000000;stroke-width:0.98812592;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter"
     transform="matrix(1,0,0,1.0241779,-34.420001,-39.095054)" />
  <polygon
     points="107,174 107,138 107,138 261,138 269,146 269,174 "
     id="polygon4567"
     style="font-size:16px;fill:#ffffff;stroke:#000000;stroke-width:1.0498203;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter"
     transform="matrix(0.82977058,0,0,1.0934829,11.371713,-47.939234)" />
  <path
     d="m 226.58,102.96141 0,8.74786"
     id="path4569"
     style="font-size:16px;fill:none;stroke:#000000;stroke-width:1;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter" />
  <path
     d="m 226.58,111.70927 8,0"
     id="path4571"
     style="font-size:16px;fill:none;stroke:#000000;stroke-width:1;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter" />
  <text
     font-size="16"
     font-style="normal"
     font-weight="normal"
     x="103.0965"
     y="117.58"
     id="text4573"
     style="font-size:16px;font-style:normal;font-weight:normal;fill:#000000;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter"
     dy="0 0 0 0 0 0 0 0 0 0 0 0 4.5">- generate dA</text>
  <text
     font-size="16"
     font-style="normal"
     font-weight="normal"
     x="103.0965"
     y="134.58"
     id="text4575"
     style="font-size:16px;font-style:normal;font-weight:normal;fill:#000000;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter"
     dx="0 0 0 0 0 0 0 0 0 0 0 0 0 0 3.9572878e-10"
     dy="0 0 0 0 0 0 0 0 0 0 4.5 -4.5 0 4.5 -4.5 0">- derive QA=dA.G</text>
  <path
     d="m 258.58,210.58816 176,0"
     id="path4577"
     style="font-size:16px;fill:none;stroke:#000000;stroke-width:1;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter" />
  <polygon
     points="301,238 293,242 301,246 "
     id="polygon4579"
     style="font-size:16px;fill:#000000;stroke:#000000;stroke-width:0.87489527;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter"
     transform="matrix(1,0,0,1.3064351,-34.420001,-105.56913)" />
  <polygon
     points="269,252 24,252 24,233 24,233 261,233 269,241 "
     id="polygon4581"
     style="font-size:16px;fill:#ffffff;stroke:#000000;stroke-width:0.90619361;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter"
     transform="matrix(0.93211646,0,0,1.3064351,-15.271411,-105.56913)" />
  <path
     d="m 226.58,198.83024 0,10.45149"
     id="path4583"
     style="font-size:16px;fill:none;stroke:#000000;stroke-width:1;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter" />
  <path
     d="m 226.58,209.28173 8,0"
     id="path4585"
     style="font-size:16px;fill:none;stroke:#000000;stroke-width:1;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter" />
  <text
     font-size="16"
     font-style="normal"
     font-weight="normal"
     x="10.019344"
     y="214.58"
     id="text4587"
     style="font-size:16px;font-style:normal;font-weight:normal;fill:#000000;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter"
     dy="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 4.5 -4.5 0 4.5">- compute shared secret dA.QB</text>
  <polygon
     points="730,224 738,232 738,260 493,260 493,224 493,224 "
     id="polygon4589"
     style="font-size:16px;fill:#ffffff;stroke:#000000;stroke-width:0.83556122;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter"
     transform="matrix(0.9127551,0,0,1.5692394,8.5917391,-180.81104)" />
  <path
     d="m 673.8043,171.19919 0,11.28717"
     id="path4591"
     style="font-size:16px;fill:none;stroke:#000000;stroke-width:1;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter" />
  <path
     d="m 673.8043,182.48636 8,0"
     id="path4593"
     style="font-size:16px;fill:none;stroke:#000000;stroke-width:1;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter" />
  <text
     font-size="16"
     font-style="normal"
     font-weight="normal"
     x="463.57999"
     y="203.58"
     id="text4595"
     style="font-size:16px;font-style:normal;font-weight:normal;fill:#000000;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter"
     dy="0 0 0 0 0 0 0 0 0 0 4.5 -4.5 0 4.5 -4.5">- derive QB=dB.G</text>
  <text
     font-size="16"
     font-style="normal"
     font-weight="normal"
     x="463.57999"
     y="220.58"
     id="text4597"
     style="font-size:16px;font-style:normal;font-weight:normal;fill:#000000;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter"
     dy="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 4.5 -4.5 0 4.5">- compute shared secret dB.QA</text>
  <text
     font-size="16"
     font-style="normal"
     font-weight="normal"
     x="262.58002"
     y="103.58"
     id="text4599"
     style="font-size:16px;font-style:normal;font-weight:normal;fill:#000000;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter"
     dy="0 0 0 0 0 0 0 4.5 -4.5 0 0 4.5 -4.5 0 0 0 0 4.5">m1: pubA, QA, sigA</text>
  <text
     font-size="16"
     font-style="normal"
     font-weight="normal"
     x="262.58002"
     y="193.33"
     id="text4603"
     style="font-size:16px;font-style:normal;font-weight:normal;fill:#000000;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter"
     dy="0 0 0 0 0 0 0 4.5 -4.5 0 0 4.5 -4.5 0 0 0 0 4.5">m2: pubB, QB, sigB</text>
  <path
     d="m 47.08,273.28624 50.45924,0"
     id="path4607"
     style="font-size:16px;fill:none;stroke:#000000;stroke-width:0.99999994;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter" />
  <path
     d="m 47.08,279.87378 50.45924,0"
     id="path4609"
     style="font-size:16px;fill:none;stroke:#000000;stroke-width:0.99999994;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter" />
  <path
     d="m 595.62076,273.28624 50.45925,0"
     id="path4611"
     style="font-size:16px;fill:none;stroke:#000000;stroke-width:0.99999994;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter" />
  <path
     d="m 595.62076,279.87378 50.45925,0"
     id="path4613"
     style="font-size:16px;fill:none;stroke:#000000;stroke-width:0.99999994;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter" />
  <rect
     height="49.406506"
     width="498.08151"
     x="97.539299"
     y="251.87675"
     id="rect4615"
     style="font-size:16px;fill:#d0d0d0;stroke:#000000;stroke-width:0.99999994;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter" />
  <text
     font-size="11"
     font-style="normal"
     font-weight="normal"
     x="199.57579"
     y="271.57999"
     id="text4617"
     style="font-size:16px;font-style:normal;font-weight:normal;fill:#000000;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter">Both client and server share a same secret:</text>
  <text
     font-size="11"
     font-style="normal"
     font-weight="normal"
     x="259.17477"
     y="287.57999"
     id="text4619"
     style="font-size:16px;font-style:normal;font-weight:normal;fill:#000000;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter"
     dy="0 4.5 -4.5 0 4.5 -4.5 0 4.5 -4.5 0 4.5 -4.5 0 4.5 -4.5 0 4.5 -4.5">dA.QB=dB.QA=dA.dB.G</text>
  <text
     style="font-size:16px;font-style:normal;font-weight:normal;fill:#000000;font-family:Bitstream Charter;-inkscape-font-specification:Bitstream Charter"
     id="text4627"
     y="185.54878"
     x="463.57999"
     font-weight="normal"
     font-style="normal"
     font-size="16"
     dy="0 0 0 0 0 0 0 0 0 0 0 0 3.1819808">- generate dB</text>
</svg>
